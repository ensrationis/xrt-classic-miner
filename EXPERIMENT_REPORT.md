# Эксперимент по чеканке XRT через механизм эмиссии Robonomics

**Дата эксперимента:** 11 февраля 2026 г.
**Сеть:** Ethereum Mainnet
**Аккаунт:** `0x6EFBA8fb2AC5b6730729a972eC224426a287C3Ad`

---

## Аннотация

Настоящий отчёт описывает эксперимент по автоматизированной чеканке токенов XRT с использованием механизма эмиссии, заложенного в смарт-контракты Robonomics Network v5. Обнаружено, что архитектура контрактов позволяет получать эмиссию XRT посредством создания и финализации «пустых» обязательств (liabilities) без выполнения реальной работы. Разработан инструмент автоматизации полного цикла: создание маяка (lighthouse), стейкинг, пакетное создание обязательств, их финализация, а также продажа полученных токенов на Uniswap V2. Отдельно исследована возможность манипулирования скользящей средней цены газа (SMMA) в контракте Factory для увеличения объёма эмиссии.

За время эксперимента добыто **24 190 XRT** (~1 360 обязательств), продано на Uniswap V2 за **0.841 ETH**, при общих расходах на газ порядка **1.20 ETH**. Финансовый результат — убыток **≈ $660**, обусловленный обвалом рыночной цены XRT под давлением собственных продаж.

---

## 1. Техническое устройство механизма эмиссии Robonomics

### 1.1. Архитектура протокола

Robonomics Network v5 — протокол на Ethereum для автоматизации взаимодействия между киберфизическими системами (роботами) и экономическими агентами. Ключевые компоненты:

| Контракт | Адрес | Назначение |
|---|---|---|
| **Factory** | `0x7e384AD1FE06747594a6102EE5b377b273DC1225` | Реестр маяков и обязательств, эмиссия XRT |
| **XRT** | `0x7dE91B204C1C737bcEe6F000AAA6569Cf7061cb7` | ERC-20 токен (9 десятичных знаков, 1 XRT = 10⁹ wn) |
| **Lighthouse** | Создаётся через Factory | Маяк — точка координации провайдеров |
| **Liability** | Создаётся через Lighthouse | Контракт обязательства (задание + результат) |
| **Auction** | `0x86da63b3341924c88baa5adbb2b8f930cc02e586` | Dutch auction, определяет `finalPrice` |

### 1.2. Жизненный цикл обязательства

```
Demand (заказчик)  ──┐
                     ├── Lighthouse.createLiability(demand, offer)
Offer  (исполнитель) ┘        │
                              ▼
                     Factory → new Liability contract
                              │
                     Lighthouse.finalizeLiability(liability, result, success, sig)
                              │
                              ▼
                     Factory.liabilityFinalized()
                        ├── XRT.mint(tx.origin, wnFromGas(gas))
                        └── totalGasConsumed += gas
```

Критический аспект: **эмиссия XRT происходит при любой финализации**, вне зависимости от содержания задания, результата или их полезности. Контракт не проверяет ни модель, ни цель, ни качество результата — лишь валидность подписей и принадлежность к маяку.

### 1.3. Формула эмиссии

Объём чеканки определяется функцией `Factory.wnFromGas()`:

```
wn = gas × gasPrice_SMMA × 10⁹ / auction.finalPrice()
```

где:

- **`gas`** — объём газа, потреблённый транзакцией финализации (типично ~268 000);
- **`gasPrice_SMMA`** — скользящая средняя цены газа (Smoothed Moving Average), обновляемая при каждом вызове `createLiability` и `finalizeLiability`:

```
gasPrice_SMMA = (gasPrice_SMMA × 999 + tx.gasprice) / 1000
```

- **`auction.finalPrice()`** — финальная цена из Dutch-аукциона (константа ~4.49 × 10¹³ на момент эксперимента).

### 1.4. Система эпох

Эмиссия дополнительно модулируется эпохами:

```
epoch = totalGasConsumed / gasEpoch
multiplier = (2/3)^epoch
```

| Параметр | Значение |
|---|---|
| `gasEpoch` | 3 470 000 000 000 |
| `totalGasConsumed` на начало | ~5.85 × 10⁹ (0.17% эпохи 0) |
| Текущий множитель | ×1.000 (эпоха 0) |
| Раундов до эпохи 1 | ~163 800 |

При переходе к эпохе 1 эмиссия снизится на 33.3%. До этого момента — десятки тысяч раундов при текущих объёмах.

### 1.5. Lighthouse и механизм квот

Маяк (Lighthouse) — контракт, координирующий провайдеров через round-robin с защитой от спама:

- **Стейк**: для участия в маяке провайдер блокирует XRT (`lighthouse.refill(amount)`);
- **Маркер**: текущий «активный» провайдер (`lighthouse.marker()`);
- **Квота**: количество операций, доступных текущему маркеру;
- **Таймаут**: через `timeoutInBlocks` блоков без активности маркер переходит к следующему провайдеру.

Для эксперимента создан собственный маяк с `timeoutInBlocks = 1` и `minimalStake = 1 wn`, что обеспечило минимальные задержки между раундами.

### 1.6. Подписи сообщений

Demand и Offer кодируются и подписываются по EIP-191 с использованием `encodePacked`:

**Demand** (268 байт):
```
model(34) ‖ objective(34) ‖ token(20) ‖ cost(32) ‖
lighthouse(20) ‖ validator(20) ‖ validatorFee(32) ‖
deadline(32) ‖ nonce(32) ‖ sender(20)
```

**Offer** (268 байт, порядок `validator ↔ lighthouse` инвертирован):
```
model(34) ‖ objective(34) ‖ token(20) ‖ cost(32) ‖
validator(20) ‖ lighthouse(20) ‖ lighthouseFee(32) ‖
deadline(32) ‖ nonce(32) ‖ sender(20)
```

**Result** (55 байт):
```
liability(20) ‖ result(34) ‖ success(1)
```

Подпись: `sign(keccak256(encodePacked(fields)), privateKey)` → 65-байтная ECDSA.

Ключевая деталь: `demand.nonce = factory.nonceOf(sender) + 2×i`, `offer.nonce = demand.nonce + 1` — фабрика инкрементирует nonce после каждого обработанного сообщения.

---

## 2. Разработка майнера

### 2.1. Архитектура инструмента

```
xrt-classic-miner/
├── pyproject.toml           # web3>=7.0, click, pyyaml, eth-account, eth-abi
├── config.yaml.example      # Пример конфигурации
└── xrt_miner/
    ├── __init__.py
    ├── __main__.py          # CLI (click): setup, mine, batch, pipeline, status, stake, swap, withdraw
    ├── abi.py               # Минимальные ABI контрактов, адреса mainnet
    ├── signer.py            # Формирование и подпись demand/offer/result
    └── miner.py             # XRTMiner: управление маяком, циклы чеканки, Uniswap-свопы
```

### 2.2. Три режима майнинга

**Режим 1 — Sequential (`mine`):**
Последовательное создание и финализация одного обязательства за раз. Использовался для отладки и проверки корректности подписей.

**Режим 2 — Batch (`batch`):**
Пакетное создание N обязательств → ожидание сброса квоты → пакетная финализация. Удваивает пропускную способность за счёт амортизации ожидания.

**Режим 3 — Pipeline (`pipeline`):**
Оптимальный режим. В каждом раунде одновременно финализируются обязательства предыдущего раунда и создаются новые:

```
Round 1: ────── CREATE(N) ─────────→  [bootstrap]
Round 2: FINALIZE(N) + CREATE(N) ──→  [pipeline]
Round 3: FINALIZE(N) + CREATE(N) ──→  [pipeline]
  ...
```

Требует 2×N квоты на маяке (N финализаций + N созданий). Обеспечивает ~2× скорость по сравнению с batch-режимом.

### 2.3. Формирование транзакций (EIP-1559)

```python
base_fee = w3.eth.gas_price
prio_wei = to_wei(priority_gwei, "gwei")
max_fee = max(base_fee + prio_wei, to_wei(1, "gwei"))
priority_fee = min(prio_wei, max_fee)
```

Транзакции формируются и подписываются заранее (`_build_tx`), затем отправляются последовательно с преинкрементированными nonce. Это позволяет отправить десятки транзакций за секунды, после чего дождаться всех receipt'ов параллельно.

### 2.4. Интеграция с Uniswap V2

Автоматическая продажа XRT при достижении порога накопления:

```
Path: XRT → WETH
Router: 0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D
Slippage: 5% (настраиваемый)
Auto-trigger: каждые sell_every_xrt XRT (по умолчанию 1000)
```

### 2.5. Динамическое управление размером пакета

При включённом `--max-cost` майнер запрашивает текущую цену ETH через Chainlink Oracle (`0x5f4eC3Df9cbd43714FE2740f5E3616155c5b8419`) и корректирует размер пакета:

```python
cost_per_liability = gas_price × GAS_PER_LIABILITY / 1e18 × eth_usd
if cost_per_liability > max_cost_usd:
    batch = int(max_batch × max_cost_usd / cost_per_liability)
```

### 2.6. Мониторинг в реальном времени

Разработан отдельный скрипт мониторинга (`xrt-monitor.py`), отображающий:

- Балансы ETH / XRT, стейк;
- Цену ETH/USD (Chainlink), текущий base fee;
- Прогресс эпохи (visual progress bar);
- Динамику SMMA (текущая, тренд, спарклайн);
- Таблицу последних раундов с разбивкой по газу;
- Совокупную прибыль/убыток в ETH и USD.

---

## 3. Подбор параметров

### 3.1. Обзор настраиваемых параметров

| Параметр | Диапазон | Описание |
|---|---|---|
| `--batch-size` | 10–56 | Количество обязательств за раунд |
| `--priority-fee` | 0.2–10 gwei | Приоритетная комиссия EIP-1559 |
| `--budget` | 1.0–2.0 ETH | Лимит расхода ETH на газ |
| `--sell-every` | 1000–2000 XRT | Порог автоматической продажи |
| `--slippage` | 5% | Допустимое проскальзывание при продаже |
| `--max-cost` | $0.50 | Максимальная стоимость одного обязательства |

### 3.2. Влияние размера пакета

Размер пакета определяет количество транзакций за раунд и, следовательно, нагрузку на RPC-провайдера.

| Batch | Txs/round | Результат |
|---|---|---|
| 56 | 112 | Тайм-ауты транзакций (DRPC не справлялся с нагрузкой) |
| 20 | 40 | Тайм-ауты (даже при 2 gwei priority) |
| **10** | **20** | **Стабильная работа, 0 ошибок за 69 раундов** |

Основная проблема batch=56: RPC-провайдер DRPC принимал транзакции и возвращал хэши, но не ретранслировал их в мемпул Ethereum. Транзакции «зависали» — их нельзя было найти ни в пуле, ни в блоках.

**Диагностика зависших транзакций:**
```python
latest = get_transaction_count(addr, 'latest')   # подтверждённые
pending = get_transaction_count(addr, 'pending')  # в мемпуле
stuck = pending - latest                          # застрявшие
```

**Решение:** снижение batch до 10 полностью устранило проблему. При 20 транзакциях за раунд DRPC стабильно обрабатывал нагрузку.

### 3.3. Влияние приоритетной комиссии

| Priority | Effective gas price | Влияние на SMMA | Gas cost/round |
|---|---|---|---|
| 10.0 gwei | ~10.2 gwei | Резкий рост SMMA (+0.18 gwei/раунд) | ~0.108 ETH |
| 2.0 gwei | ~2.2 gwei | Умеренный рост | ~0.023 ETH |
| **1.0 gwei** | **~1.2 gwei** | **Медленное снижение SMMA** | **~0.013 ETH** |
| 0.2 gwei | ~0.45 gwei | Быстрое снижение SMMA | ~0.005 ETH |

Формула эффективной цены газа для контракта:
```
tx.gasprice = min(maxFeePerGas, baseFee + maxPriorityFeePerGas)
```

Контракт видит `tx.gasprice` и обновляет SMMA:
```
SMMA_new = (SMMA_old × 999 + tx.gasprice) / 1000
```

Таким образом, приоритетная комиссия одновременно:
1. Влияет на стоимость газа для майнера (прямые расходы);
2. Определяет направление и скорость движения SMMA (влияет на будущую эмиссию).

### 3.4. Порог продажи

При `sell-every=2000` автоматическая продажа срабатывала каждые ~6 раундов. За 69 раундов произведено 11 продаж на Uniswap V2:

| Продажа # | XRT продано | ETH получено | Цена ETH/XRT | Изменение |
|---|---|---|---|---|
| 1 | 4 801 | 0.161558 | 0.00003365 | — |
| 2 | 2 094 | 0.069128 | 0.00003301 | −1.9% |
| 3 | 2 019 | 0.065870 | 0.00003263 | −1.2% |
| 4 | 2 331 | 0.075817 | 0.00003252 | −0.3% |
| 5 | 2 248 | 0.072325 | 0.00003218 | −1.0% |
| 6 | 2 177 | 0.069183 | 0.00003178 | −1.2% |
| 7 | 2 116 | 0.066450 | 0.00003140 | −1.2% |
| 8 | 2 064 | 0.064211 | 0.00003111 | −0.9% |
| 9 | 2 256 | 0.069402 | 0.00003076 | −1.1% |
| 10 | 2 146 | 0.065208 | 0.00003039 | −1.2% |
| 11 | 2 044 | 0.061474 | 0.00003007 | −1.1% |
| **Итого** | **26 296** | **0.840626** | **0.00003197** (avg) | **−10.6%** |

Цена XRT снизилась на 10.6% за 11 продаж (~1.3 часа). На тонком рынке Uniswap V2 с ограниченной ликвидностью каждая продажа оказывала ощутимое давление.

---

## 4. Эксперимент с манипулированием скользящей средней (Pump & Mine)

### 4.1. Гипотеза

Поскольку эмиссия XRT пропорциональна `gasPrice_SMMA`, а SMMA обновляется на основе `tx.gasprice` каждой транзакции, возникает возможность **искусственного завышения SMMA** через отправку транзакций с высоким приоритетом. Стратегия:

1. **Фаза «Pump»**: отправить серию раундов с высоким priority fee (10 gwei), быстро подняв SMMA;
2. **Фаза «Mine»**: переключиться на минимальный priority fee (1 gwei) и добывать XRT с повышенной эмиссией, пока SMMA не вернётся к норме.

### 4.2. Параметры фазы «Pump»

```
Priority fee:  10 gwei
Batch size:    56
Budget:        2.0 ETH
Effective gas: ~10.2 gwei
```

### 4.3. Результаты фазы «Pump»

| Показатель | Значение |
|---|---|
| Раундов завершено | 4 |
| SMMA до начала | ~1.03 gwei |
| SMMA после пампа | ~4.0 gwei |
| ETH потрачено на газ | ~2.27 ETH |
| XRT добыто (pump) | ~15 519 XRT |
| XRT продано после pump | ~16 899 XRT |
| ETH от продажи | ~0.763 ETH |

Каждый раунд из 56 обязательств генерировал 112 вызовов контракта (56 create + 56 finalize), и каждый вызов сдвигал SMMA на:

```
Δ_SMMA = (10.2 − SMMA) / 1000
```

За 4 раунда × 112 вызовов = 448 вызовов, SMMA поднялась с 1.03 до ~4.0 gwei (×3.9).

### 4.4. Параметры фазы «Mine»

```
Priority fee:  1 gwei
Batch size:    10 (снижен из-за проблем с RPC)
Budget:        1.0 ETH
Max cost:      $0.50/liability
Sell every:    2000 XRT
```

### 4.5. Результаты фазы «Mine»

| Показатель | Значение |
|---|---|
| Раундов завершено | 69 |
| Ошибок / тайм-аутов | 0 |
| SMMA в начале | ~1.94 gwei |
| SMMA в конце | ~1.41 gwei |
| XRT добыто | 24 190 XRT |
| Средний XRT/раунд | 355.73 XRT |
| XRT в первом раунде | 443.66 XRT |
| XRT в последнем раунде | 257.13 XRT |
| Снижение эмиссии | −42.0% |
| Газ потрачен | ~728 916 000 gas |
| XRT продано | 26 296 XRT |
| ETH от продаж | 0.841 ETH |

### 4.6. Динамика затухания SMMA

SMMA экспоненциально стремится к `tx.gasprice` текущих транзакций:

```
SMMA(n+1) = SMMA(n) + (tx.gasprice − SMMA(n)) / 1000
```

При `tx.gasprice ≈ 1.2 gwei` и 20 вызовах/раунд:

```
SMMA после раунда = SMMA × (999/1000)²⁰ + 1.2 × (1 − (999/1000)²⁰)
                   ≈ SMMA × 0.9802 + 1.2 × 0.0198
```

**Период полураспада:** ~35 раундов (SMMA теряет половину разрыва с целевым значением).

Наблюдаемая динамика SMMA (выборочные точки):

| Раунд | SMMA (gwei) | XRT/раунд | Δ SMMA |
|---|---|---|---|
| 2 | 1.94 | 443.66 | — |
| 10 | 1.82 | 415.50 | −0.12 |
| 20 | 1.68 | 386.95 | −0.14 |
| 30 | 1.58 | 365.40 | −0.10 |
| 40 | 1.51 | 348.71 | −0.07 |
| 50 | 1.46 | 303.51 | −0.05 |
| 60 | 1.42 | 294.54 | −0.04 |
| 69 | 1.41 | 257.13 | −0.01 |

### 4.7. Анализ рентабельности Pump & Mine

**Фаза Pump:**

| Статья | Значение |
|---|---|
| Расход на газ (pump) | ~2.27 ETH |
| Доход от продажи pump XRT | ~0.76 ETH |
| Чистый убыток pump | ~−1.51 ETH |

Фаза pump по определению убыточна: мы переплачиваем за газ, чтобы «инвестировать» в повышение будущей эмиссии.

**Фаза Mine:**

| Статья | Значение |
|---|---|
| Расход на газ (mine) | ~0.84 ETH |
| Доход от продажи XRT | 0.841 ETH |
| Чистый результат mine | ~0.00 ETH |

Фаза mine вышла примерно в ноль по ETH: доходы от продажи XRT компенсировали расходы на газ. Однако прибыль pump фазы не была отбита.

**Совокупный результат:**

```
Стартовый ETH:           3.544
Финальный ETH:           3.182
XRT на руках:            675 XRT (~0.020 ETH)
────────────────────────────────────
Изменение ETH:          −0.362
+ стоимость XRT:        +0.020
────────────────────────────────────
Чистый убыток:          −0.342 ETH (~$665)
```

### 4.8. Причины убыточности

1. **Обвал цены XRT под давлением продаж.** Продажа 26 296 XRT на тонком рынке Uniswap V2 снизила цену на 10.6% за 1.3 часа. Каждая последующая продажа получала меньше ETH.

2. **Высокая стоимость фазы pump.** 2.27 ETH за 4 раунда при 10 gwei priority — основная статья убытков. Pump поднял SMMA до 4.0 gwei, но к моменту начала mine (после смены конфигурации и решения проблем с RPC) SMMA уже опустилась до 1.94 gwei.

3. **Задержка между pump и mine.** Переход между фазами занял время из-за необходимости финализировать оставшиеся обязательства, продать XRT, изменить параметры и решить проблемы с тайм-аутами транзакций. За это время SMMA снизилась с 4.0 до 1.94 gwei — потеряна половина эффекта пампа.

4. **Затухание SMMA быстрее, чем ожидалось.** С batch=10 (20 вызовов/раунд) SMMA снижалась на ~2% за раунд. Окно повышенной эмиссии оказалось ограниченным.

### 4.9. Моделирование альтернативного сценария

При priority fee = 0.2 gwei (effective ≈ 0.45 gwei) и текущей SMMA = 1.41 gwei моделирование показало:

| Параметр | Значение |
|---|---|
| Прибыльных раундов | 73 |
| Breakeven SMMA | 0.674 gwei |
| Steady-state SMMA | 0.45 gwei (ниже breakeven) |
| Теоретическая прибыль | 0.147 ETH ($286) |

При снижении priority fee до 0.2 gwei газ обходится в 3× дешевле, но SMMA быстрее конвергирует к 0.45 gwei, после чего эмиссия падает ниже точки безубыточности. Окно прибыльности — ~73 раунда (1.2 часа), теоретический доход ~$286.

---

## 5. Уникальность с точки зрения проектирования смарт-контрактов

### 5.1. Основная находка

Механизм эмиссии XRT представляет собой **редкий пример неограниченной инфлятивной модели с экзогенным оракулом стоимости, встроенным в саму логику расчёта эмиссии**.

В абсолютном большинстве токенов с mining-механикой (Bitcoin, ERC-20 mining tokens) эмиссия зависит от:
- фиксированного графика (Bitcoin halving);
- proof-of-work (hashrate);
- proof-of-stake (locked collateral);
- governance (Maker, Compound).

Robonomics использует принципиально иной подход: **эмиссия пропорциональна цене газа, которую платит сам майнер**. Это создаёт уникальный рефлексивный цикл:

```
майнер платит больше за газ
    → SMMA растёт
        → эмиссия растёт
            → больше XRT чеканится
                → майнер может продать больше XRT
                    → стимул платить ещё больше за газ
```

### 5.2. SMMA как внутренний оракул — архитектурная уязвимость

Скользящая средняя в `Factory.gasPrice` де-факто является **внутренним ценовым оракулом**, подверженным манипуляции:

1. **Период сглаживания (1000) слишком мал** при массовых операциях. 448 вызовов (4 раунда по 56 × 2) сдвинули SMMA на ×3.9 — с 1.03 до 4.0 gwei.

2. **Отсутствует верхняя граница SMMA.** Теоретически SMMA можно поднять до произвольного уровня, ограниченного лишь бюджетом атакующего.

3. **Нет привязки к внешнему оракулу газа.** SMMA целиком определяется `tx.gasprice` участников системы, а не рыночной ценой газа. В 2026 году, когда base fee на Ethereum составляет ~0.2 gwei, SMMA можно поднять до десятков gwei за минимальный бюджет.

### 5.3. Отсутствие валидации полезности

Контракт `Factory.liabilityFinalized()` чеканит XRT при **любой** финализации. Не проверяется:

- Соответствие результата модели/цели;
- Нетривиальность задания (модель и цель могут быть случайными байтами);
- Реальность выполнения работы;
- Разность сторон обязательства (promisee == promisor).

Это **by design**: протокол полагается на экономические стимулы (стоимость газа должна превышать ценность получаемых XRT). В условиях высокого газа (>50 gwei, 2021–2023) эта модель работала: стоимость создания обязательства делала бессмысленную чеканку экономически невыгодной. В условиях сверхнизкого газа 2026 года (~0.2 gwei) — защитный механизм не работает.

### 5.4. Сравнение с известными DeFi-уязвимостями

| Класс уязвимости | Robonomics SMMA | Типичные примеры |
|---|---|---|
| Oracle manipulation | SMMA как внутренний оракул, управляемый `tx.gasprice` | TWAP-манипуляция в Uniswap V2 |
| Flash loan attack | Невозможна (SMMA меняется на 0.1% за вызов) | bZx, Cream Finance |
| Emission gaming | Создание пустых обязательств для получения эмиссии | Curve gauge weight manipulation |
| Reflexive incentive | Больше газа → больше XRT → стимул тратить ещё больше газа | Token rebasing (Ampleforth) |

В отличие от Flash Loan атак, манипуляция SMMA — **медленная**: необходимы сотни транзакций для значимого сдвига. Это одновременно и защита (высокая стоимость атаки), и ограничение (нельзя извлечь выгоду за один блок).

### 5.5. Контекст дизайна протокола

Справедливости ради, контракты Robonomics v5 были спроектированы в 2018–2020 годах, когда:

- Средняя цена газа на Ethereum составляла 20–200 gwei;
- Стоимость создания одного обязательства (~1M gas × 50 gwei) = ~0.05 ETH ≈ $15–100;
- При таких ценах бессмысленная чеканка была очевидно убыточной;
- SMMA в диапазоне 20–200 gwei естественным образом отражала рыночную цену газа.

В 2026 году ландшафт кардинально изменился:

- Base fee = 0.2 gwei (в 100–1000× ниже);
- Стоимость обязательства: 0.0002 ETH ≈ $0.40;
- SMMA можно «накачать» за $100–200 расходов на газ;
- Рефлексивный цикл эмиссии стал экономически эксплуатируемым.

### 5.6. Выводы

Эксперимент демонстрирует нетривиальный пример того, как **изменение внешних условий** (стоимость газа на L1) может превратить корректно спроектированный экономический механизм в уязвимость. Основные уроки:

1. **Внутренние оракулы опасны.** SMMA, управляемая непосредственно `tx.gasprice` пользователей, — это по сути оракул, контролируемый участниками системы. Современный стандарт — использование внешних оракулов (Chainlink, TWAP с длинным окном).

2. **Экономические предположения не вечны.** Модель, рассчитанная на газ >20 gwei, потеряла защитные свойства при газе <1 gwei. Это аналогично тому, как протоколы кредитования ломаются при резком обвале залоговых активов.

3. **Emission farming — устойчивый паттерн.** Если эмиссия токена зависит от действий пользователей (а не от внешних факторов), она будет оптимизирована до точки безубыточности. Robonomics, Curve, Liquity — все столкнулись с этой проблемой.

4. **Период сглаживания критичен.** SMMA_period = 1000 — слишком мал для устойчивости к направленной манипуляции. При десятках вызовов в минуту 1000 вызовов — это менее часа.

---

## Приложения

### A. Газовые параметры (наблюдаемые)

| Операция | Gas (observed) |
|---|---|
| `createLiability` | 789 000 ± 5 000 |
| `finalizeLiability` | 267 000 ± 1 000 |
| `swapExactTokensForETH` (Uniswap V2) | 112 000 ± 3 000 |
| Суммарно на одно обязательство | 1 058 000 |
| Раунд (10 create + 10 finalize) | 10 564 000 |

### B. Контрактные адреса

| Контракт | Адрес |
|---|---|
| Factory | `0x7e384AD1FE06747594a6102EE5b377b273DC1225` |
| XRT (ERC-20) | `0x7dE91B204C1C737bcEe6F000AAA6569Cf7061cb7` |
| Lighthouse (custom) | `0x04C672af1e54d6C9Bd3f153d590f5681d8EcbbeE` |
| Auction | `0x86da63b3341924c88baa5adbb2b8f930cc02e586` |
| Uniswap V2 Router | `0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D` |
| Chainlink ETH/USD | `0x5f4eC3Df9cbd43714FE2740f5E3616155c5b8419` |
| WETH | `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` |

### C. Хронология эксперимента

| Время | Событие |
|---|---|
| T+0 | Запуск pump: batch=56, priority=10 gwei |
| T+15m | Pump завершён (4 раунда, бюджет 2.27 ETH), SMMA = 4.0 gwei |
| T+20m | Финализация оставшихся обязательств, продажа 16 899 XRT |
| T+25m | Запуск mine #1: batch=56, priority=1 gwei — тайм-ауты на раундах 13, 17 |
| T+45m | Рестарт mine #2: batch=56, priority=2 gwei — тайм-аут на раунде 1 |
| T+55m | Рестарт mine #3: batch=20, priority=2 gwei — тайм-аут |
| T+60m | Рестарт mine #4: batch=10, priority=1 gwei — **стабильная работа** |
| T+135m | 69 раундов завершено, 0 ошибок, майнинг убыточен |
| T+140m | Остановка всех процессов |
